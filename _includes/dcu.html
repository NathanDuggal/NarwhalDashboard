<div id="dcu" class="flexbox column">
    <div class="flexbox column" style="display: flex; font-size: 14pt">
        <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
            <div style="text-align: center; background: white; padding: 8px; margin: 16px 8px 0px 16px">
                <b style="font-size: 20pt; margin-bottom: 4px;">Step 1: Wheel Circumference</b><br>
                
                In order to determine wheel circumference, reset the drive encoders, and push the robot (yes, by hand) exactly 100 inches.
                <br><br>
                <table cellspacing="4px" style="width: 100%; font-size: 18pt; text-align: center;">
                    <tr>
                        <td width="45%">
                            <div onmousedown='buttonDown("resetEncoders")' class="button royal flexbox" style="align-items: center; height: 150px; border-radius: 12px; padding: 20px; vertical-align: middle;">
                                <div><b>Reset Drive Encoders</b></div>
                            </div> 
                        </td>
                        <td>
                            <div>Wheel Circumference</div>
                            <div id="wheelCirc" style="font-size: 50pt; line-height: 46pt;">--</div>
                            <div>inches</div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
            <div style="text-align: center; background: white; padding: 8px; margin: 16px 8px 0px 8px">
                <div>
                    <b style="font-size: 20pt; margin-bottom: 4px;">Step 2: Max Speeds and Speed Scalars</b>
                </div>
                <br><br>
                <div onmousedown='buttonDown("resetMaxSpeed")' class="button navy" style="flex: 0 0 auto; border-radius: 12px; padding: 10px 14px;">
                    <b>Reset Values</b>
                </div> 

                <br>
                
                <table cellspacing="4px" style="width: 100%; font-size: 18pt; text-align: center;">
                    <tr>
                        <td colspan="2">
                            <b style="font-size: 20pt;">Maximum Speed</b>
                            <div style="font-size: 14pt;">
                                Drive the robot in place by turning the joystick hard to the left; reset, then turn hard to the right. Take the lesser of the four speeds as the maximum speed for autonomous driving.
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div>Left</div>
                            <div id="left_max_speed" style="font-size: 60pt; line-height: 50pt;">0.0</div>
                            nu/100ms
                        </td>
                        <td>
                            <div>Right</div>
                            <div id="right_max_speed" style="font-size: 60pt; line-height: 50pt;">0.0</div>
                            nu/100ms
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <b style="font-size: 20pt;">Speed Scalars</b>
                            <div style="font-size: 14pt;">
                                Drive the robot full speed forward and record the scalars. Note: Do NOT apply these before determining Max Speed and Feed-Forward.
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div>Left</div>
                            <div id="leftSpeedScalar" style="font-size: 60pt; line-height: 50pt;">1.0</div>
                        </td>
                        <td>
                            <div>Right</div>
                            <div id="rightSpeedScalar" style="font-size: 60pt; line-height: 50pt;">1.0</div>
                        </td>
                    </tr>
                </table>
                <br>
            </div>
        </div>
        <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
            <div style="text-align: center; background: white; padding: 8px; margin: 16px 16px 0px 8px">
                <b style="font-size: 20pt; margin-bottom: 4px;">Step 3: Effective Wheelbase</b>
                <br>
                To determine the effective wheelbase of the robot, change the left and right applied powers and run the program. Run the program a couple of times to get a feel for what the ballpark wheelbase should be.
                <br><br>
                Then, only add values in this range to the average (throw out anything that seems like an outlier). 
                <br><br>

                <div style="flex: 0 1 100%; display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 12px; margin-bottom: 8px;">
                    <div>
                        <text style="font-size: 24pt">Left Power</text>
                        <br>
                        <input id="l_pow" style="font-size: 24pt; width: 100%"/>
                    </div>
                    <div>
                        <text style="font-size: 24pt">Right Power</text>
                        <br>
                        <input id="r_pow" style="font-size: 24pt; width: 100%"/>
                    </div>
                </div>

                <text style="font-size: 16pt">Duration (ms):</text> 
                <input id="l_pow" style="font-size: 16pt; width: 100%; margin-bottom: 12px;"/>

                <div onclick="wheelbase()" class="button navy flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;; margin-bottom: 24px;">
                    <div><b>Run Calibration Program</b></div>
                </div> 

                <div style="flex: 0 1 100%; display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 12px;">
                    <text style="font-size: 18pt;">Most Recent<br>Wheelbase</text>
                    <text style="font-size: 18pt;">Running Average<br>Wheelbase</text>

                    <div>
                        <div id="prev_wb" style="font-size: 50pt; line-height: 46pt;">--</div>
                        inches
                    </div>                    
                    <div>
                        <div id="avg_wb" style="font-size: 50pt; line-height: 46pt;">--</div>
                        inches
                    </div>

                    <div onclick="buttonDown('add_wb_to_avg')" class="button sapphire flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;">
                        <div><b>Add to Average</b></div>
                    </div> 
                    <div onclick="buttonDown('reset_wb_avg')" class="button royal flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;">
                        <div><b>Reset Average</b></div>
                    </div> 
                </div>
            </div>
        </div>
        <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
            <div style="text-align: center; background: white; padding: 8px; margin: 16px 16px 0px 8px">
                <b style="font-size: 20pt; margin-bottom: 4px;">Step 4: PPF Multiplier</b>
                <br>
                To determine the respective ppf multipliers(Left/Right) of the robot, change the left and right applied powers and run the program. Run the program with increments of 0.05 starting from -1 to 1 for both sides.
                <br><br>
                Then, add the values to the csv string by clicking the button below, which will then get printed when you select the button: "Print CSV"
                <br><br>

                <div style="flex: 0 1 100%; display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 12px; margin-bottom: 8px;">
                    <div>
                        <text style="font-size: 24pt">Left Power</text>
                        <br>
                        <input id="l_pow_ffp" style="font-size: 24pt; width: 100%"/>
                    </div>
                    <div>
                        <text style="font-size: 24pt">Right Power</text>
                        <br>
                        <input id="r_pow_ffp" style="font-size: 24pt; width: 100%"/>
                    </div>
                </div>

                <text style="font-size: 16pt">Duration (ms):</text> 
                <input id="ffp_dur" style="font-size: 16pt; width: 100%; margin-bottom: 12px;"/>

                <div onclick="ffpCalibration()" class="button navy flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;; margin-bottom: 24px;">
                    <div><b>Run Calibration Program</b></div>
                </div> 

                <text style="font-size: 18pt;">Most Recent<br>FFP(L/R)</text>
                <div style="flex: 0 1 100%; display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 12px;">
                    <div>
                        <div id="prev_ffpL" style="font-size: 50pt; line-height: 46pt;">--</div>
                    </div>                    
                    <div>
                        <div id="prev_ffpR" style="font-size: 50pt; line-height: 46pt;">--</div>
                    </div>

                    <div onclick="buttonDown('printCSV')" class="button sapphire flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;">
                        <div><b>Print CSV</b></div>
                    </div> 
                    <div onclick="buttonDown('remLast')" class="button royal flexbox column squarish" style="font-size: 16pt; padding: 8px; text-align: center;">
                        <div><b>Remove Last Pair</b></div>
                    </div> 
                </div>
            </div>
            <div style="background: white; padding: 8px; margin: 16px 8px 0px 16px">
                <div style="text-align: center;">
                    <b style="font-size: 20pt; margin-bottom: 4px;">Step 5: Motion Profile/Motion Magic PID</b>
                    
                    <div onmousedown='buttonDown("pidCalDrive")' class="button navy" style="flex: 0 0 auto; border-radius: 12px; padding: 10px 14px;">
                        <b>100 inch Drive Test</b>
                    </div> 
                </div>

                <ol>
                    <li>Measure and mark a distance of 100 inches.</li>
                    <li>Press the button to run the MotionMagic drive 100 inches program.</li>
                    <li>Increase the Motion Profile P gain in until the robot travels exactly 100 inches with no overshoot.</li>
                    <li>With P gain properly tuned, you may need to add a small amount of D gain to reduce overshoot.</li>
                </ol>
            </div>
        </div>
    </div>

    <div style="flex: 0 0 auto; background: white; margin: 16px;">
        <table width="100%" cellspacing="8px">
            <tr>
                <td rowspan="3" style="text-align: center;">
                    <b style="font-size: 20pt; margin-bottom: 4px;">PID Constants</b>
                </td>
                <td rowspan="2" style="text-align: center;">
                    <text style="font-size: 20pt; margin-bottom: 4px;">Left</text>
                    <br>
                    F: <input id="l_f" />
                </td>
                <td>
                    <b>Motion Profile</b>&nbsp&nbsp
                    <div class="flexbox row" style="flex-wrap: wrap;">
                        <div>P: <input id="l_mp_p" /> &nbsp</div>
                        <div>I: <input id="l_mp_i" /> &nbsp</div>
                        <div>D: <input id="l_mp_d" /> &nbsp</div>
                    </div>
                </td>
                <td rowspan="2" style="text-align: center;">
                    <span style="font-size: 20pt; margin-bottom: 4px;">Right</span>
                    <br>
                    F: <input id="r_f" />
                </td>
                <td>
                    <b>Motion Profile</b>&nbsp&nbsp
                    <div class="flexbox row" style="flex-wrap: wrap;">
                        <div>P: <input id="r_mp_p" /> &nbsp</div>
                        <div>I: <input id="r_mp_i" /> &nbsp</div>
                        <div>D: <input id="r_mp_d" /> &nbsp</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <b>Velocity</b>&nbsp&nbsp
                    <div class="flexbox row" style="flex-wrap: wrap;">
                        <div>P: <input id="l_v_p" /> &nbsp</div>
                        <div>I: <input id="l_v_i" /> &nbsp</div>
                        <div>D: <input id="l_v_d" /> &nbsp</div>
                    </div>
                </td>
                <td>
                    <b>Velocity</b>&nbsp&nbsp
                    <div class="flexbox row" style="flex-wrap: wrap;">
                        <div>P: <input id="r_v_p" /> &nbsp</div>
                        <div>I: <input id="r_v_i" /> &nbsp</div>
                        <div>D: <input id="r_v_d" /> &nbsp</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td rowspan="2" colspan="2">
                    <div onclick='pushLeftPID()' class="button sapphire" style="border-radius: 12px; padding: 10px 14px; text-align: center">
                        <div><b>Save Left PID Constants</b></div>
                    </div> 
                </td>
                <td rowspan="2" colspan="2">
                    <div onclick='pushRightPID()' class="button pacific" style="border-radius: 12px; padding: 10px 14px; text-align: center">
                        <div><b>Save Right PID Constants</b></div>
                    </div> 
                </td>
            </tr>
        </table>
        
    </div>
</div>