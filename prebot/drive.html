---
layout: default
robot: PreBot
tab: Drive Calibration Utility

permalink: /prebot/drive/
---

<div class="flexbox row" style="display: flex; font-size: 14pt">
    <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
        <div style="text-align: center; background: white; padding: 8px; margin: 16px 8px 0px 16px">
            <b style="font-size: 20pt; margin-bottom: 4px;">Step 1: Wheel Circumference</b><br>
            
            In order to determine wheel circumference, reset the drive encoders, and push the robot (yes, by hand) exactly 100 inches.

            <table cellspacing="4px" style="width: 100%; font-size: 18pt; text-align: center;">
                <tr>
                    <td width="45%">
                        <div onmousedown='buttonDown("wheelbase")' class="button royal flexbox" style="align-items: center; height: 150px; border-radius: 12px; padding: 20px; vertical-align: middle;">
                            <div><b>Reset Drive Encoders</b></div>
                        </div> 
                    </td>
                    <td>
                        Wheel Circumference
                        <br>
                        <span style="font-size: 50pt; line-height: 46pt;">0in</span>
                    </td>
                </tr>
            </table>
        </div>

        <div style="background: white; padding: 8px; margin: 16px 8px 0px 16px">
            <div style="text-align: center;">
                <b style="font-size: 20pt; margin-bottom: 4px;">Step 4: Motion Profile/Motion Magic PID</b>

                <div onmousedown='buttonDown("pidCalDrive")' class="button navy" style="flex: 0 0 auto; border-radius: 12px; padding: 10px 14px;">
                    <b>100 inch Drive Test</b>
                </div> 
            </div>

            <ol>
                <li>Measure and mark a distance of 100 inches.</li>
                <li>Press the button to run the MotionMagic drive 100 inches program.</li>
                <li>Adjust the PID_kP value in the main robot class until the robot travels exactly 100 inches with no overshoot. Be sure to redeploy each time.</li>
            </ol>
        </div>
    </div>
    <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
        <div style="text-align: center; background: white; padding: 8px; margin: 16px 8px 0px 8px">
            <b style="font-size: 20pt; margin-bottom: 4px;">Step 2: Feed-Forward and Speed Scalars</b>
            <br>
            To determine both quanties, drive the robot around (on carpet) at max power with max throttle until they stop changing.
            <br><br>

            <div onmousedown='buttonDown("resetMaxSpeed")' class="button navy" style="flex: 0 0 auto; border-radius: 12px; padding: 10px 14px;">
                <b>Reset Maximum Speeds</b>
            </div> 

            <table cellspacing="4px" style="width: 100%; font-size: 18pt; text-align: center;">
                <tr>
                    <td colspan="2">
                        <b style="font-size: 20pt;">Feed-Forward</b><br>
                        <i style="font-size: 14pt;">Note: Set these before setting Speed Scalars.</i>
                    </td>
                </tr>
                <tr>
                    <td>
                        Left kF
                        <br>
                        <span style="font-size: 60pt; line-height: 50pt;">--</span>
                    </td>
                    <td>
                        Right kF
                        <br>
                        <span style="font-size: 60pt; line-height: 50pt;">--</span>
                    </td>
                </tr>
                <tr>
                        <td colspan="2">
                            <b style="font-size: 20pt;">Speed Scalars</b><br>
                            <i style="font-size: 14pt;">Note: Do NOT apply these before determining Feed-Forward.</i>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Left
                            <br>
                            <span style="font-size: 60pt; line-height: 50pt;">1.0</span>
                        </td>
                        <td>
                            Right
                            <br>
                            <span style="font-size: 60pt; line-height: 50pt;">1.0</span>
                        </td>
                    </tr>
            </table>
            <br>
        </div>
    </div>
    <div style="flex: 1 1 33%; padding: 0px; margin: 0px">
        <div style="text-align: center; background: white; padding: 8px; margin: 16px 16px 0px 8px">
            <b style="font-size: 20pt; margin-bottom: 4px;">Step 3: Effective Wheelbase</b>
            <br>
            NOTE: To get an accurate reading, you must callibrate the velocity PID, which should be stored in the drive Talon's PID slot 1. This can be done by attempting to minimize the velocity error below.
            <br><br>
            Press the button and wait for a value to be displayed.
            <br>
            <table cellspacing="4px" style="width: 100%; font-size: 18pt; text-align: center;">
                <tr>
                    <td width="45%">
                        <div onmousedown='buttonDown("wheelbase")' class="button royal flexbox" style="align-items: center; height: 250px; border-radius: 12px; padding: 20px; vertical-align: middle;">
                            <div><b>Run Callibration Program</b></div>
                        </div> 
                    </td>
                    <td>
                        Calculated Effective Wheelbase
                        <br>
                        <span style="font-size: 50pt; line-height: 46pt;">--in</span>

                        <br><br>

                        Velocity Error
                        <br>
                        <span style="font-size: 50pt; line-height: 46pt;">--</span>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <!-- <div colspan="3" style="width: 100%; background: white;">
        <div style="text-align: center;"><b>PID</b></div>
    </div> -->
</div>

<!-- <font style="font-size: 18pt; font-weight: bold"><u>Directions</u></font>

<font style="font-size: 13pt; font-weight: bold">1. Wheel Circumference</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;a. Mark the top of the front wheel with tape.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;b. Push the robot in a straight line for 100 inches and record the number of rotations.</blockquote></font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;c. The Wheel Circumference is 100 divided by the number of rotations.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;d. Go to the main robot class and adjust the value titled wheelCirc.</font>

<font style="font-size: 13pt; font-weight: bold">2. Speed Scalar</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;a. Open up the Smart Dashboard using the search bar, click File, then New. Ensure the Right and Left Max Speed is displayed.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;b. Turn the throttle to maximum and run the robot forward at max speed. Record these values (these values can also be used for step 3).</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;c. Divide smaller value by the greater value. Set the speedScalar in the main robot class.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;d. If the right value is greater, change setLeftSpeedScalar to setRightSpeedScaler, and vise versa.</font>

<font style="font-size: 13pt; font-weight: bold">3. Feet Forward</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;a. If not already done so in step 2, open Smart Dashboard using the search bar, click File, then New. Ensure that the Right and Left Max Speed is displayed.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;b. If not already done so in Step 2, turn throttle to max and drive the robot around at full speed.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;c. Record the maximum speeds and divide 1023 by the lower of the two speeds.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;d. Change the value titled PID_kF in the main robot class.</font>

<font style="font-size: 13pt; font-weight: bold">4. Wheel Base</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;a. Ensure the robot has enough space to go in a circle with a 5 foot diameter.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;b. Run WheelBase auto file by going to the Dashboard, selecting it from the Auto dropdown, and going to the Drivers Station and selecting Autonomous, then Enable.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;c. Wait for the robot to finish, click Disable, and check the log in the Drivers Station for the calculated Wheel Base.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;d. Select ArcTurn on Narwhal Dashboard and run it.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;e. Verify that the robot travels exactly 90 degrees.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;f. Adjust Wheel Base as necessary (greater Wheel Base equates to a greater degree turned).</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;g. Go to the main robot class and adjust the value titled wheelBase.</font>

<font style="font-size: 13pt; font-weight: bold">5. PID Value</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;a. Measure 100 inches and mark on the ground.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;b. Run the 100inchRun auto by going to the Dashboard, then selecting 100inchRun from the auto dropdown.</font>
<font style="font-size: 13pt; font-weight: normal">&ensp;&emsp;&ensp;c. Adjust the PID_kP value in the main robot class until the robot travels exactly 100 inches. Be sure to redeploy each time. A higher p value equals more distance.</font> -->
